generator client {
  provider   = "prisma-client"
  output     = "../generated/prisma"
  engineType = "client"
}

datasource db {
  provider = "mysql"
}

model UserProfileLink {
  id     Int     @id @default(autoincrement())
  userId Int?
  icon   String?
  link   String
  User   User?   @relation(fields: [userId], references: [id])

  @@index([userId], map: "UserProfileLink_userId_fkey")
}

model User {
  id            Int               @id @default(autoincrement())
  email         String            @unique
  username      String            @unique
  password      String
  bio           String?
  avatar        String?
  badge         String?
  savedArticles String?
  statusIcon    String?
  statusTooltip String?
  pinned        Int?
  pronouns      String?
  suspended     Boolean?
  geminiKey     String?
  apps          App[]
  likes         PostLike[]
  mentions      PostMention[]
  links         UserProfileLink[]
}

model TempCode {
  id    Int    @id @default(autoincrement())
  code  Int
  email String
}

model PostLike {
  userId Int
  postId Int
  post   Post @relation(fields: [postId], references: [id])
  user   User @relation(fields: [userId], references: [id])

  @@id([userId, postId])
  @@index([postId], map: "PostLike_postId_fkey")
}

model Subscription {
  id   Int @id @default(autoincrement())
  from Int
  to   Int
}

model Comment {
  publishDate DateTime? @default(now())
  id          Int       @id @default(autoincrement())
  authorId    Int
  content     String    @db.LongText
  postId      Int?
  Post        Post?     @relation(fields: [postId], references: [id])

  @@index([postId], map: "Comment_postId_fkey")
}

model Post {
  id              Int           @id @default(autoincrement())
  title           String        @default("")
  content         String        @db.LongText
  imageUrl        String?
  authorId        Int?          @default(0)
  publishDate     DateTime?     @default(now())
  deleted         Boolean?      @default(false)
  userId          Int?
  writtenBy       Int?          @default(0)
  commentsEnabled Boolean       @default(true)
  comments        Comment[]
  likes           PostLike[]
  mentions        PostMention[]
}

model PostMention {
  postId Int
  userId Int
  Post   Post @relation(fields: [postId], references: [id])
  User   User @relation(fields: [userId], references: [id])

  @@id([postId, userId])
  @@index([userId], map: "PostMention_userId_fkey")
}

model Message {
  id       Int      @id @default(autoincrement())
  chatName String
  date     DateTime @default(now())
  content  String
  author   String?
}

model Community {
  id          Int     @id @default(autoincrement())
  avatar      String?
  bio         String?
  subscribers Int?
  badge       String?
  ownerId     Int
  admins      String
  name        String?
  visibility  String
}

model App {
  id          Int    @id @default(autoincrement())
  userId      Int?
  title       String @unique
  description String @db.LongText
  url         String @unique
  User        User?  @relation(fields: [userId], references: [id])

  @@index([userId], map: "App_userId_fkey")
}
